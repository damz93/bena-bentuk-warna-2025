
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar Warna & Bentuk - Untuk Anak 2-6 Tahun</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 20px 0;
            border-radius: 0 0 20px 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            margin-bottom: 20px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .shape-card {
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .shape {
            transition: transform 0.3s;
        }
        
        .shape:hover {
            transform: scale(1.1);
        }
        
        .color-box {
            height: 120px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .color-box:hover {
            transform: scale(1.05);
        }
        
        .btn-mode {
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 600;
            margin: 5px;
        }
        
        .footer {
            background-color: #f1f1f1;
            padding: 20px 0;
            margin-top: 30px;
            border-radius: 20px 20px 0 0;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            background-color: white;
        }
        
        .locked-feature {
            position: relative;
            filter: grayscale(100%);
        }
        
        .locked-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }
        
        .lock-icon {
            color: white;
            font-size: 40px;
        }
        
        /* Bentuk shapes */
        .circle {
            width: 100px;
            height: 100px;
            background-color: #FF5252;
            border-radius: 50%;
        }
        
        .square {
            width: 100px;
            height: 100px;
            background-color: #4CAF50;
        }
        
        .triangle {
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 100px solid #2196F3;
        }
        
        .rectangle {
            width: 140px;
            height: 80px;
            background-color: #FFC107;
        }
        
        .oval {
            width: 140px;
            height: 80px;
            background-color: #9C27B0;
            border-radius: 50%;
        }
        
        .star {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .star:before {
            content: "â˜…";
            color: #E91E63;
            font-size: 100px;
            line-height: 0;
        }
        
        .diamond {
            width: 100px;
            height: 100px;
            background-color: #00BCD4;
            transform: rotate(45deg);
        }
        
        .heart {
            position: relative;
            width: 100px;
            height: 90px;
        }
        
        .heart:before,
        .heart:after {
            content: "";
            position: absolute;
            left: 50px;
            top: 0;
            width: 50px;
            height: 80px;
            background: #FF4081;
            border-radius: 50px 50px 0 0;
            transform: rotate(-45deg);
            transform-origin: 0 100%;
        }
        
        .heart:after {
            left: 0;
            transform: rotate(45deg);
            transform-origin: 100% 100%;
        }
        
        .active-mode {
            background-color: #6a11cb;
            color: white;
        }
        
        #quiz-container {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            border-radius: 15px;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .quiz-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .quiz-option {
            width: 140px;
            height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 10px;
            border: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .quiz-option:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .quiz-option.selected {
            border-color: #6a11cb;
        }
        
        #shapes-section, #colors-section, #quiz-container {
            display: none;
        }
        
        .tab-button {
            background-color: #f8f9fa;
            color: #6c757d;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 600;
            margin: 0 5px;
            transition: all 0.3s;
        }
        
        .tab-button.active {
            background-color: #6a11cb;
            color: white;
        }
        
        .plus-feature {
            display: none;
        }
        
        #quiz-audio-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 15px;
            padding: 5px 15px;
            border-radius: 50px;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="container">
        <div class="login-container">
            <div class="text-center mb-4">
                <h2 class="fw-bold text-primary">Belajar Warna & Bentuk</h2>
                <p class="text-muted">Untuk Anak 2-6 Tahun</p>
            </div>
            <div class="mb-3">
                <label for="access-code" class="form-label">Kode Akses:</label>
                <input type="text" class="form-control" id="access-code" placeholder="Masukkan kode akses">
            </div>
            <button id="login-btn" class="btn btn-primary w-100 py-2">Masuk</button>
            <div class="text-center mt-3">
                <small class="text-muted">Gunakan "trial" untuk versi terbatas atau kode premium untuk semua fitur.</small>
            </div>
        </div>
    </div>

    <!-- Main App (hidden initially) -->
    <div id="app-container" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h1 class="fw-bold">Belajar Warna & Bentuk</h1>
                        <p>Untuk Anak 2-6 Tahun</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <span class="badge bg-warning" id="version-badge">Versi Trial</span>
                        <button id="logout-btn" class="btn btn-light btn-sm ms-2">Keluar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container">
            <!-- Mode Selection -->
            <div class="row justify-content-center mb-4">
                <div class="col-md-8 text-center">
                    <div class="bg-white p-3 rounded-pill shadow-sm">
                        <button class="tab-button active" id="btn-shapes">Bentuk</button>
                        <button class="tab-button" id="btn-colors">Warna</button>
                        <button class="tab-button" id="btn-quiz">Kuis</button>
                    </div>
                </div>
            </div>

            <!-- Learning Mode Selection -->
            <div class="row justify-content-center mb-4" id="learning-mode-container">
                <div class="col-md-8 text-center">
                    <div class="bg-white p-3 rounded shadow-sm">
                        <button class="btn btn-mode active-mode" id="btn-learn-mode">Mode Belajar</button>
                        <button class="btn btn-mode" id="btn-quiz-mode">Mode Kuis</button>
                    </div>
                </div>
            </div>

            <!-- Shapes Section -->
            <div id="shapes-section">
                <div class="row">
                    <!-- Basic Shapes (Available in Trial) -->
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="card shape-card" data-shape="lingkaran">
                            <div class="shape circle mx-auto"></div>
                            <div class="card-footer text-center">Lingkaran</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="card shape-card" data-shape="persegi">
                            <div class="shape square mx-auto"></div>
                            <div class="card-footer text-center">Persegi</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="card shape-card" data-shape="segitiga">
                            <div class="shape triangle mx-auto"></div>
                            <div class="card-footer text-center">Segitiga</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="card shape-card" data-shape="persegi-panjang">
                            <div class="shape rectangle mx-auto"></div>
                            <div class="card-footer text-center">Persegi Panjang</div>
                        </div>
                    </div>

                    <!-- Premium Shapes (Only in Plus version) -->
                    <div class="col-6 col-md-4 col-lg-3 plus-feature">
                        <div class="card shape-card locked-feature" data-shape="oval">
                            <div class="shape oval mx-auto"></div>
                            <div class="locked-overlay" id="oval-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Oval</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 plus-feature">
                        <div class="card shape-card locked-feature" data-shape="bintang">
                            <div class="shape star mx-auto"></div>
                            <div class="locked-overlay" id="star-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Bintang</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 plus-feature">
                        <div class="card shape-card locked-feature" data-shape="belah-ketupat">
                            <div class="shape diamond mx-auto"></div>
                            <div class="locked-overlay" id="diamond-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Belah Ketupat</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 plus-feature">
                        <div class="card shape-card locked-feature" data-shape="hati">
                            <div class="shape heart mx-auto"></div>
                            <div class="locked-overlay" id="heart-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Hati</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Colors Section -->
            <div id="colors-section">
                <div class="row">
                    <!-- Basic Colors (Available in Trial) -->
                    <div class="col-6 col-md-4 col-lg-3 mb-4">
                        <div class="card" data-color="merah">
                            <div class="color-box" style="background-color: #FF0000;"></div>
                            <div class="card-footer text-center">Merah</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 mb-4">
                        <div class="card" data-color="biru">
                            <div class="color-box" style="background-color: #0000FF;"></div>
                            <div class="card-footer text-center">Biru</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 mb-4">
                        <div class="card" data-color="hijau">
                            <div class="color-box" style="background-color: #00FF00;"></div>
                            <div class="card-footer text-center">Hijau</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 mb-4">
                        <div class="card" data-color="kuning">
                            <div class="color-box" style="background-color: #FFFF00;"></div>
                            <div class="card-footer text-center">Kuning</div>
                        </div>
                    </div>

                    <!-- Premium Colors (Only in Plus version) -->
                    <div class="col-6 col-md-4 col-lg-3 mb-4 plus-feature">
                        <div class="card locked-feature" data-color="ungu">
                            <div class="color-box" style="background-color: #800080;"></div>
                            <div class="locked-overlay" id="purple-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Ungu</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 mb-4 plus-feature">
                        <div class="card locked-feature" data-color="oranye">
                            <div class="color-box" style="background-color: #FFA500;"></div>
                            <div class="locked-overlay" id="orange-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Oranye</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 mb-4 plus-feature">
                        <div class="card locked-feature" data-color="pink">
                            <div class="color-box" style="background-color: #FFC0CB;"></div>
                            <div class="locked-overlay" id="pink-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Pink</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-3 mb-4 plus-feature">
                        <div class="card locked-feature" data-color="coklat">
                            <div class="color-box" style="background-color: #A52A2A;"></div>
                            <div class="locked-overlay" id="brown-lock">
                                <i class="lock-icon">ðŸ”’</i>
                            </div>
                            <div class="card-footer text-center">Coklat</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quiz Container -->
            <div id="quiz-container">
                <h3 id="quiz-question" class="mb-4">Mana yang berbentuk segitiga?</h3>
                <div class="quiz-options" id="quiz-options">
                    <!-- Quiz options will be dynamically added here -->
                </div>
                <div class="mt-4">
                    <button id="check-answer" class="btn btn-primary">Periksa Jawaban</button>
                    <button id="next-question" class="btn btn-success ms-2" style="display: none;">Lanjut</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer mt-5">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <p class="mb-0">Belajar Warna & Bentuk Â© 2025</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p class="mb-0">Untuk anak-anak 2-6 tahun</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Configuration
        const PREMIUM_CODE = "plus"; // Code for premium access
        const TRIAL_CODE = "trial"; // Code for trial access
        
        // Application state
        let isPremium = false;
        let currentMode = "learn"; // "learn" or "quiz"
        let currentTab = "shapes"; // "shapes" or "colors" or "quiz"
        let currentQuizType = "shapes"; // "shapes" or "colors"
        let currentQuestion = null;
        let selectedAnswer = null;
        
        // Audio elements for pronouncing shapes and colors
        const audio = new Audio();
        
        // Shapes and colors data
        const shapes = {
            basic: [
                { id: "lingkaran", name: "Lingkaran" },
                { id: "persegi", name: "Persegi" },
                { id: "segitiga", name: "Segitiga" },
                { id: "persegi-panjang", name: "Persegi Panjang" }
            ],
            premium: [
                { id: "oval", name: "Oval" },
                { id: "bintang", name: "Bintang" },
                { id: "belah-ketupat", name: "Belah Ketupat" },
                { id: "hati", name: "Hati" }
            ]
        };
        
        const colors = {
            basic: [
                { id: "merah", name: "Merah", color: "#FF0000" },
                { id: "biru", name: "Biru", color: "#0000FF" },
                { id: "hijau", name: "Hijau", color: "#00FF00" },
                { id: "kuning", name: "Kuning", color: "#FFFF00" }
            ],
            premium: [
                { id: "ungu", name: "Ungu", color: "#800080" },
                { id: "oranye", name: "Oranye", color: "#FFA500" },
                { id: "pink", name: "Pink", color: "#FFC0CB" },
                { id: "coklat", name: "Coklat", color: "#A52A2A" }
            ]
        };
        
        // DOM Elements
        const loginScreen = document.getElementById('login-screen');
        const appContainer = document.getElementById('app-container');
        const accessCodeInput = document.getElementById('access-code');
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const versionBadge = document.getElementById('version-badge');
        const btnShapes = document.getElementById('btn-shapes');
        const btnColors = document.getElementById('btn-colors');
        const btnQuiz = document.getElementById('btn-quiz');
        const shapesSection = document.getElementById('shapes-section');
        const colorsSection = document.getElementById('colors-section');
        const quizContainer = document.getElementById('quiz-container');
        const learningModeContainer = document.getElementById('learning-mode-container');
        const btnLearnMode = document.getElementById('btn-learn-mode');
        const btnQuizMode = document.getElementById('btn-quiz-mode');
        const quizQuestion = document.getElementById('quiz-question');
        const quizOptions = document.getElementById('quiz-options');
        const checkAnswerBtn = document.getElementById('check-answer');
        const nextQuestionBtn = document.getElementById('next-question');
        
        // Event Listeners
        loginBtn.addEventListener('click', handleLogin);
        logoutBtn.addEventListener('click', handleLogout);
        btnShapes.addEventListener('click', () => switchTab('shapes'));
        btnColors.addEventListener('click', () => switchTab('colors'));
        btnQuiz.addEventListener('click', () => switchTab('quiz'));
        btnLearnMode.addEventListener('click', () => switchMode('learn'));
        btnQuizMode.addEventListener('click', () => switchMode('quiz'));
        checkAnswerBtn.addEventListener('click', checkAnswer);
        nextQuestionBtn.addEventListener('click', generateQuestion);
        
        // Setup shape and color click handlers
        document.querySelectorAll('.shape-card').forEach(card => {
            card.addEventListener('click', function() {
                if (this.classList.contains('locked-feature') && !isPremium) {
                    showPremiumAlert();
                    return;
                }
                const shape = this.getAttribute('data-shape');
                pronounce(shape);
            });
        });
        
        document.querySelectorAll('[data-color]').forEach(card => {
            card.addEventListener('click', function() {
                if (this.classList.contains('locked-feature') && !isPremium) {
                    showPremiumAlert();
                    return;
                }
                const color = this.getAttribute('data-color');
                pronounce(color);
            });
        });
        
        // Login Functions
        function handleLogin() {
            const code = accessCodeInput.value.trim().toLowerCase();
            
            if (!code) {
                Swal.fire({
                    title: 'Oops!',
                    text: 'Kode akses tidak boleh kosong',
                    icon: 'error',
                    confirmButtonColor: '#6a11cb'
                });
                return;
            }
            
            if (code === PREMIUM_CODE) {
                isPremium = true;
                loginSuccess('plus');
            } else if (code === TRIAL_CODE) {
                isPremium = false;
                loginSuccess('trial');
            } else {
                Swal.fire({
                    title: 'Kode Akses Salah',
                    text: 'Silakan coba lagi atau gunakan "trial" untuk versi terbatas',
                    icon: 'error',
                    confirmButtonColor: '#6a11cb'
                });
            }
        }
        
        function loginSuccess(version) {
            loginScreen.style.display = 'none';
            appContainer.style.display = 'block';
            
            if (version === 'plus') {
                versionBadge.textContent = 'Versi Plus';
                versionBadge.classList.remove('bg-warning');
                versionBadge.classList.add('bg-success');
                
                // Show premium features
                document.querySelectorAll('.plus-feature').forEach(element => {
                    element.style.display = 'block';
                });
                
                // Remove locks
                document.querySelectorAll('.locked-overlay').forEach(lock => {
                    lock.style.display = 'none';
                });
                
                document.querySelectorAll('.locked-feature').forEach(feature => {
                    feature.classList.remove('locked-feature');
                });
                
                Swal.fire({
                    title: 'Selamat Datang di Versi Plus!',
                    text: 'Kamu sekarang memiliki akses ke semua fitur pembelajaran warna dan bentuk',
                    icon: 'success',
                    confirmButtonColor: '#6a11cb'
                });
            } else {
                versionBadge.textContent = 'Versi Trial';
                
                Swal.fire({
                    title: 'Selamat Datang di Versi Trial!',
                    text: 'Kamu memiliki akses terbatas. Gunakan kode premium untuk mengakses semua fitur',
                    icon: 'info',
                    confirmButtonColor: '#6a11cb'
                });
            }
            
            switchTab('shapes');
        }
        
        function handleLogout() {
            loginScreen.style.display = 'block';
            appContainer.style.display = 'none';
            accessCodeInput.value = '';
            isPremium = false;
            
            // Reset to trial version
            document.querySelectorAll('.plus-feature').forEach(element => {
                element.style.display = 'none';
            });
            
            document.querySelectorAll('.locked-overlay').forEach(lock => {
                lock.style.display = 'flex';
            });
            
            Swal.fire({
                title: 'Sampai Jumpa!',
                text: 'Kamu berhasil keluar dari aplikasi',
                icon: 'success',
                confirmButtonColor: '#6a11cb'
            });
        }
        
        // Tab switching
        function switchTab(tab) {
            currentTab = tab;
            
            // Update tab buttons
            [btnShapes, btnColors, btnQuiz].forEach(btn => btn.classList.remove('active'));
            
            if (tab === 'shapes') {
                btnShapes.classList.add('active');
                shapesSection.style.display = 'block';
                colorsSection.style.display = 'none';
                quizContainer.style.display = 'none';
                learningModeContainer.style.display = 'block';
                switchMode(currentMode);
            } else if (tab === 'colors') {
                btnColors.classList.add('active');
                shapesSection.style.display = 'none';
                colorsSection.style.display = 'block';
                quizContainer.style.display = 'none';
                learningModeContainer.style.display = 'block';
                switchMode(currentMode);
            } else if (tab === 'quiz') {
                btnQuiz.classList.add('active');
                shapesSection.style.display = 'none';
                colorsSection.style.display = 'none';
                quizContainer.style.display = 'block';
                learningModeContainer.style.display = 'none';
                generateQuestion();
            }
        }
        
        // Mode switching (learn or quiz)
        function switchMode(mode) {
            currentMode = mode;
            
            if (currentTab === 'quiz') {
                return; // Quiz tab has its own quiz mode
            }
            
            [btnLearnMode, btnQuizMode].forEach(btn => btn.classList.remove('active-mode'));
            
            if (mode === 'learn') {
                btnLearnMode.classList.add('active-mode');
                quizContainer.style.display = 'none';
                
                if (currentTab === 'shapes') {
                    shapesSection.style.display = 'block';
                } else if (currentTab === 'colors') {
                    colorsSection.style.display = 'block';
                }
            } else if (mode === 'quiz') {
                btnQuizMode.classList.add('active-mode');
                shapesSection.style.display = 'none';
                colorsSection.style.display = 'none';
                quizContainer.style.display = 'block';
                currentQuizType = currentTab;
                generateQuestion();
            }
        }
        
        // Quiz functions
        function generateQuestion() {
            // Reset UI
            nextQuestionBtn.style.display = 'none';
            checkAnswerBtn.style.display = 'inline-block';
            selectedAnswer = null;
            quizOptions.innerHTML = '';
            
            // Decide what to quiz on based on current tab or previous quiz type
            currentQuizType = (currentTab === 'quiz') ? 
                (Math.random() > 0.5 ? 'shapes' : 'colors') : currentTab;
            
            let allItems = [];
            
            if (currentQuizType === 'shapes') {
                allItems = [...shapes.basic];
                if (isPremium) {
                    allItems = [...allItems, ...shapes.premium];
                }
                
                // Pick a random shape to ask about
                const correctIndex = Math.floor(Math.random() * allItems.length);
                currentQuestion = {
                    type: 'shapes',
                    correct: allItems[correctIndex],
                    options: getRandomOptions(allItems, correctIndex)
                };
                
                const questionText = `Mana yang berbentuk ${currentQuestion.correct.name}?`;
                quizQuestion.textContent = questionText;
                
                // Speak the question
                speakQuestion(questionText);
                
                // Add audio button
                addAudioButton(questionText);
                
                // Generate shape options
                currentQuestion.options.forEach((shape, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'quiz-option';
                    optionDiv.setAttribute('data-answer', shape.id);
                    
                    // Create proper shape element based on shape id
                    const shapeDiv = document.createElement('div');
                    
                    if (shape.id === "lingkaran") {
                        shapeDiv.className = "shape circle";
                    } else if (shape.id === "persegi") {
                        shapeDiv.className = "shape square"; 
                    } else if (shape.id === "segitiga") {
                        shapeDiv.className = "shape triangle";
                    } else if (shape.id === "persegi-panjang") {
                        shapeDiv.className = "shape rectangle";
                    } else if (shape.id === "oval") {
                        shapeDiv.className = "shape oval";
                    } else if (shape.id === "bintang") {
                        shapeDiv.className = "shape star";
                    } else if (shape.id === "belah-ketupat") {
                        shapeDiv.className = "shape diamond";
                    } else if (shape.id === "hati") {
                        shapeDiv.className = "shape heart";
                    }
                    
                    optionDiv.appendChild(shapeDiv);
                    quizOptions.appendChild(optionDiv);
                    
                    optionDiv.addEventListener('click', function() {
                        // Remove selected class from all options
                        document.querySelectorAll('.quiz-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Add selected class to this option
                        this.classList.add('selected');
                        selectedAnswer = this.getAttribute('data-answer');
                    });
                });
            } else {
                allItems = [...colors.basic];
                if (isPremium) {
                    allItems = [...allItems, ...colors.premium];
                }
                
                // Pick a random color to ask about
                const correctIndex = Math.floor(Math.random() * allItems.length);
                currentQuestion = {
                    type: 'colors',
                    correct: allItems[correctIndex],
                    options: getRandomOptions(allItems, correctIndex)
                };
                
                const questionText = `Mana yang berwarna ${currentQuestion.correct.name}?`;
                quizQuestion.textContent = questionText;
                
                // Speak the question
                speakQuestion(questionText);
                
                // Add audio button
                addAudioButton(questionText);
                
                // Generate color options
                currentQuestion.options.forEach((color, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'quiz-option';
                    optionDiv.setAttribute('data-answer', color.id);
                    optionDiv.style.backgroundColor = color.color;
                    quizOptions.appendChild(optionDiv);
                    
                    optionDiv.addEventListener('click', function() {
                        // Remove selected class from all options
                        document.querySelectorAll('.quiz-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Add selected class to this option
                        this.classList.add('selected');
                        selectedAnswer = this.getAttribute('data-answer');
                    });
                });
            }
        }
        
        function speakQuestion(text) {
            if ('speechSynthesis' in window) {
                // Cancel any ongoing speech
                window.speechSynthesis.cancel();
                
                const speech = new SpeechSynthesisUtterance();
                speech.text = text;
                speech.lang = 'id-ID';
                speech.volume = 1;
                speech.rate = 0.9;
                speech.pitch = 1;
                
                window.speechSynthesis.speak(speech);
            }
        }
        
        function addAudioButton(text) {
            // Remove existing audio button if any
            const existingBtn = document.getElementById('quiz-audio-btn');
            if (existingBtn) {
                existingBtn.remove();
            }
            
            // Create audio button
            const audioBtn = document.createElement('button');
            audioBtn.id = 'quiz-audio-btn';
            audioBtn.className = 'btn btn-sm btn-outline-primary ms-2';
            audioBtn.innerHTML = 'ðŸ”Š Dengarkan';
            audioBtn.addEventListener('click', function() {
                speakQuestion(text);
            });
            
            // Add button after question text
            quizQuestion.parentNode.insertBefore(audioBtn, quizQuestion.nextSibling);
        }
        
        function getRandomOptions(allItems, correctIndex) {
            // Create a copy of all items
            const options = [...allItems];
            
            // Get the correct answer
            const correctAnswer = options[correctIndex];
            
            // Remove the correct answer from the options
            options.splice(correctIndex, 1);
            
            // Shuffle the remaining options
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }
            
            // Get 3 random options (or fewer if there aren't enough)
            const randomOptions = options.slice(0, 3);
            
            // Add back the correct answer
            randomOptions.push(correctAnswer);
            
            // Shuffle one more time to randomize position of correct answer
            for (let i = randomOptions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [randomOptions[i], randomOptions[j]] = [randomOptions[j], randomOptions[i]];
            }
            
            return randomOptions;
        }
        
        function checkAnswer() {
            if (!selectedAnswer) {
                Swal.fire({
                    title: 'Oops!',
                    text: 'Silakan pilih jawaban terlebih dahulu',
                    icon: 'warning',
                    confirmButtonColor: '#6a11cb'
                });
                return;
            }
            
            if (selectedAnswer === currentQuestion.correct.id) {
                // Correct answer
                Swal.fire({
                    title: 'Benar!',
                    text: `Ya, itu adalah ${currentQuestion.correct.name}!`,
                    icon: 'success',
                    confirmButtonColor: '#6a11cb'
                });
                
                // Play sound
                pronounce(currentQuestion.correct.id);
                
                // Show next question button
                checkAnswerBtn.style.display = 'none';
                nextQuestionBtn.style.display = 'inline-block';
            } else {
                // Wrong answer
                Swal.fire({
                    title: 'Coba Lagi',
                    text: 'Jawaban tidak tepat. Silakan coba lagi!',
                    icon: 'error',
                    confirmButtonColor: '#6a11cb'
                });
            }
        }
        
        // Helper function to pronounce the shape or color name
        function pronounce(id) {
            // In a real application, you would use actual audio files here
            // For this example, we'll use the Web Speech API for demonstration
            if ('speechSynthesis' in window) {
                const speech = new SpeechSynthesisUtterance();
                
                // Find the name from the arrays
                let name = "";
                
                // Check in shapes
                let found = shapes.basic.find(shape => shape.id === id);
                if (found) {
                    name = found.name;
                } else {
                    found = shapes.premium.find(shape => shape.id === id);
                    if (found) {
                        name = found.name;
                    }
                }
                
                // Check in colors if not found in shapes
                if (!name) {
                    found = colors.basic.find(color => color.id === id);
                    if (found) {
                        name = found.name;
                    } else {
                        found = colors.premium.find(color => color.id === id);
                        if (found) {
                            name = found.name;
                        }
                    }
                }
                
                if (name) {
                    speech.text = name;
                    speech.lang = 'id-ID';
                    speech.volume = 1;
                    speech.rate = 0.9;
                    speech.pitch = 1;
                    
                    window.speechSynthesis.speak(speech);
                    
                    // Visual feedback
                    Swal.fire({
                        title: name,
                        showConfirmButton: false,
                        timer: 1500,
                        customClass: {
                            title: 'fs-1 fw-bold'
                        }
                    });
                }
            } else {
                console.log("Browser tidak mendukung Web Speech API");
                
                // Fallback visual feedback
                let name = "";
                
                // Check in shapes
                let found = shapes.basic.find(shape => shape.id === id);
                if (found) {
                    name = found.name;
                } else {
                    found = shapes.premium.find(shape => shape.id === id);
                    if (found) {
                        name = found.name;
                    }
                }
                
                // Check in colors if not found in shapes
                if (!name) {
                    found = colors.basic.find(color => color.id === id);
                    if (found) {
                        name = found.name;
                    } else {
                        found = colors.premium.find(color => color.id === id);
                        if (found) {
                            name = found.name;
                        }
                    }
                }
                
                if (name) {
                    Swal.fire({
                        title: name,
                        showConfirmButton: false,
                        timer: 1500,
                        customClass: {
                            title: 'fs-1 fw-bold'
                        }
                    });
                }
            }
        }
        
        function showPremiumAlert() {
            Swal.fire({
                title: 'Fitur Premium',
                text: 'Fitur ini hanya tersedia di versi Plus. Masukkan kode "plus" untuk mengakses semua fitur.',
                icon: 'info',
                confirmButtonColor: '#6a11cb'
            });
        }
        
        // Handle Enter key on login
        accessCodeInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                handleLogin();
            }
        });
    </script>
</body>
</html>